
vetapp/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ Database.php			<-- completada
â”‚   â”‚   â””â”€â”€ config.php 				<-- sin iniciar
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ AuthController.php		<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â””â”€â”€ UserController.php		<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ clients/
â”‚   â”‚   â”‚   â””â”€â”€ ClientController.php		<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pets/
â”‚   â”‚   â”‚   â””â”€â”€ PetController.php		<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ consultations/
â”‚   â”‚   â”‚   â””â”€â”€ ConsultationController.php	<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ medications/
â”‚   â”‚   â”‚   â””â”€â”€ MedicationController.php	<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ sales/
â”‚   â”‚       â””â”€â”€ SaleController.php		<-- sin iniciar
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ AuthMiddleware.php			<-- sin iniciar
â”‚   â”‚   â””â”€â”€ RoleMiddleware.php			<-- sin iniciar
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ User.php				<-- sin iniciar
â”‚   â”‚   â”œâ”€â”€ Client.php				<-- sin iniciar
â”‚   â”‚   â”œâ”€â”€ Pet.php				<-- sin iniciar
â”‚   â”‚   â”œâ”€â”€ Consultation.php			<-- sin iniciar
â”‚   â”‚   â”œâ”€â”€ Medication.php			<-- sin iniciar
â”‚   â”‚   â””â”€â”€ Sale.php				<-- sin iniciar
â”‚   â”‚
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ login.php			<-- sin iniciar
â”‚   â”‚   â”‚   â””â”€â”€ logout.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â””â”€â”€ index.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.php			<-- sin iniciar
â”‚   â”‚   â”‚   â”œâ”€â”€ create.php			<-- sin iniciar
â”‚   â”‚   â”‚   â””â”€â”€ edit.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ clients/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.php			<-- sin iniciar
â”‚   â”‚   â”‚   â”œâ”€â”€ create.php			<-- sin iniciar
â”‚   â”‚   â”‚   â””â”€â”€ edit.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pets/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.php			<-- sin iniciar
â”‚   â”‚   â”‚   â”œâ”€â”€ create.php			<-- sin iniciar
â”‚   â”‚   â”‚   â””â”€â”€ edit.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ consultations/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.php			<-- sin iniciar
â”‚   â”‚   â”‚   â””â”€â”€ create.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ medications/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.php			<-- sin iniciar
â”‚   â”‚   â”‚   â””â”€â”€ create.php			<-- sin iniciar
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ sales/
â”‚   â”‚       â”œâ”€â”€ index.php			<-- sin iniciar
â”‚   â”‚       â””â”€â”€ create.php			<-- sin iniciar		
â”‚   â”‚
â”‚   â”œâ”€â”€ helpers/
â”‚   â”‚    â”œâ”€â”€ auth.php				<-- sin iniciar
â”‚   â”‚    â””â”€â”€ redirect.php			<-- sin iniciar
â”‚   â”‚
â”‚   â””â”€â”€ repositories/
â”‚        â””â”€â”€ UserRepository.php	
â”‚
â”‚
â”‚
â”œâ”€â”€ database/
â”‚   â””â”€â”€ vetapp.sql				<-- listo
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ styles.css				<-- descargada bootswatch "https://bootswatch.com/litera/"
â”‚   â”‚
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ app.js				<-- descargada la version desde bootstrap
â”‚   â”‚
â”‚   â”œâ”€â”€ img/					<-- imagenes cargadas para el login
â”‚   â”‚
â”‚   â””â”€â”€ index.php				<-- creada la vista del index con el formulario
â”‚
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ uploads/				<-- sin iniciar
â”‚   â””â”€â”€ logs/					<-- sin iniciar
â”‚
â”œâ”€â”€ .htaccess					<-- sin iniciar
â””â”€â”€ README.md					<-- sin iniciar


----------------------------------------------------------------------
flujo de autenticacion:

ğŸ§  FLUJO CORRECTO DEL LOGIN (MVC limpio)
1ï¸) La VISTA (login.php)

ğŸ“Œ Responsabilidad:
Solo mostrar el formulario y enviar datos.

â¡ï¸ Destino: AuthController

2ï¸) El CONTROLADOR (AuthController)

ğŸ‘‰ llama a: UserRepository

3) El REPOSITORY (UserRepository)

ğŸ“Œ Responsabilidad:
Hablar exclusivamente con la base de datos.

Hace solo esto:

Busca el usuario por email

 * Convierte el registro en un objeto User

 * Devuelve el objeto al controlador

4) De vuelta al CONTROLADOR

Ahora el controlador tiene:

$user = $userRepository->findByEmail($email);


Entonces decide:

âŒ Si $user === null â†’ error

âŒ Si $user->isActive() === false â†’ error

âŒ Si $user->verifyPassword($password) === false â†’ error

âœ… Si todo estÃ¡ bien â†’ login OK

ğŸ“Œ AquÃ­ se verifica la contraseÃ±a


5) SESIÃ“N (aÃºn en el controlador)

Si todo fue correcto:

Se crea $_SESSION['user']

Se guarda:

id

nombre completo

rol

ğŸ“Œ La sesiÃ³n NO vive en el modelo
ğŸ“Œ La sesiÃ³n NO vive en el repository

6) REDIRECCIÃ“N (final)

El controlador decide:

Admin â†’ dashboard admin

Veterinario â†’ dashboard vet

Pharmacy â†’ ventas

â¡ï¸ Redirige a la vista correspondiente

ğŸ” RESUMEN EN UNA SOLA LÃNEA
VISTA â†’ CONTROLADOR â†’ REPOSITORY â†’ CONTROLADOR â†’ SESIÃ“N â†’ VISTA

ğŸ§© QUIÃ‰N HACE QUÃ‰ (regla que no se rompe)
Capa	Hace
Vista	Formulario, HTML
Controlador	Coordina, valida, decide
Repository	BD â†” objetos
Modelo (User)	Reglas del dominio
SesiÃ³n	Solo controlador
ğŸš¨ ERROR COMÃšN (que tÃº YA superaste)



ğŸ”œ SIGUIENTE PASO LÃ“GICO

ğŸ‘‰ Construir AuthController limpio con PDO + UserRepository

Cuando quieras, seguimos desde cero, sin copiar cÃ³digo viejo ğŸ‘
