
vetapp/
|
+-- .htaccess
+-- FOLDER STRUCTURE.txt
+-- README.md
|
+-- app/
|   +-- bootstrap.php
|   |
|   +-- config/
|   |   +-- config.php
|   |   +-- Database.php
|   |
|   +-- controllers/
|   |   +-- auth/
|   |   |   +-- AuthController.php
|   |   |
|   |   +-- clients/
|   |   |   +-- ClientController.php
|   |   |
|   |   +-- consultations/
|   |   |   +-- ConsultationController.php
|   |   |
|   |   +-- medications/
|   |   |   +-- MedicationController.php
|   |   |
|   |   +-- pets/
|   |   |   +-- PetController.php
|   |   |
|   |   +-- sales/
|   |   |   +-- SaleController.php
|   |   |
|   |   +-- users/
|   |       +-- UserController.php
|   |
|   +-- helpers/
|   |   +-- auth.php
|   |   +-- redirect.php
|   |
|   +-- middleware/
|   |   +-- AuthMiddleware.php
|   |   +-- RoleMiddleware.php
|   |
|   +-- models/
|   |   +-- User.php
|   |
|   +-- repositories/
|   |   +-- UserRepository.php
|   |
|   +-- views/
|       +-- auth/
|       +-- clients/
|       +-- consultations/
|       +-- dashboard/
|       |   +-- index.php
|       +-- pets/
|       +-- sales/
|       +-- users/
|
+-- database/
|   +-- vetapp.sql
|
+-- public/
|   +-- dashboard.php
|   +-- index.php
|   +-- logout.php
|   |
|   +-- css/
|   |   +-- bootstrap.min.css
|   |   +-- style.css
|   |
|   +-- img/
|   |   +-- img-veterinaria.jpg
|   |   +-- login-bg-my-pets.png
|   |   +-- login-bg.jpg
|   |
|   +-- js/
|       +-- bootstrap.bundle.min.js
|
+-- storage/
    +-- logs/
    +-- uploads/

----------------------------------------------------------------------
auth flow (english - ASCII)

1) VIEW (public/index.php)
Responsibility:
Show login form and POST to the same file.

2) CONTROLLER (app/controllers/auth/AuthController.php)
Runs in public/index.php when POST arrives.
Validates email and password, loads user, verifies credentials.

3) REPOSITORY (app/repositories/UserRepository.php)
Responsibility:
Talk to the database and return user data + roles.

4) SESSION (in the controller)
If everything is ok:
Create $_SESSION['user'] with id, email, name, roles.

5) REDIRECT (final)
Controller should redirect to the protected front controller:
public/dashboard.php

6) MIDDLEWARE (app/middleware/AuthMiddleware.php)
public/dashboard.php calls AuthMiddleware::handle()
If no session -> redirect to public/index.php
If session -> load the view:
app/views/dashboard/index.php

ONE LINE SUMMARY
public/index.php -> AuthController -> UserRepository -> SESSION -> public/dashboard.php -> AuthMiddleware -> app/views/dashboard/index.php

WHO DOES WHAT (do not break this rule)
View: form, HTML
Controller: coordinate, validate, decide
Repository: DB -> data
Model: domain rules
Session: controller only
